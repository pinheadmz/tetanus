use tetanus::math::*;
use tetanus::elgamal::*;

#[test]
fn test_fast_pow() {
    assert_eq!(fast_pow(&d("12"), &d("9")), d("5159780352"));
    assert_eq!(fast_pow(&d("94380"), &d("239")), d("9915475565664474247908907587842678231286547904949270746471735976143354540876767420081830013583361997697197275499906189634255462768402784345486497599611727357207826076755736771488158245641682722314793784287472862427001229624750999693888270440705011404332527194695775513293858599468135880386017104972179120701545239736006145077111814842482955119062209109857180778283239405767120224310665748330372952974288102923318491359525297631916334788683011125526170197872929779470790330321204967187244144484016857270300327235519849840998696860339228154057672586368420782004429165583298070837152394141614054390645288802888437032271247286373877719005408263575681905465145740676601911231403983557473748987458999115238143091295782534907272024638050334183895283640984780259054139557335352749632094548633433838730492586694623078077702096125592138795085725571078486866450212688153425485524782603998399569221539904872789075399166113952372187006934567645669721615426073395200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"));
    assert_eq!(fast_pow(&d("333"), &d("444")), d("9230807129241764448885616320583540045479530253259406735065985216617990730919881112328849103285135376081878486348473472388462222819360993740290983928209254622077173254795275346693033770781527396930282882216584854831090968717563745086706374589391907503122909869042661021255805684067131170236629741824830474943321467115928675505491105928553912354028100269442162629014279481204779505132605346209921277379309773459582541323721056156883714950388707721941016473884346767332056077482324999220545491909097865289348886825001906107907364900585204382363299783603222214949055145842195613071990288012389640115918605533066350964239203288504489484585719193092687582479019066495366296634676542900145619839154964129834417386101651702532589198324031573878943352353447337367982912778289172240659728133872713086594174755367080461064258067508082644719918815397475658139171641789793651785063520979827574244829295330952975442270078672153929465464780002623020969353008225256705836674388729690957672162694677337349496056166321839163079987967767436641657621458755531260692965508099281712857128665757371634125862088552147754979848082518517659377521"));
    assert_eq!(fast_pow_mod(&d("28139"), &d("9283"), &d("23")), d("7"));
    assert_eq!(fast_pow_mod(&d("66"), &d("77"), &d("88888")), d("28936"));
}

#[test]
fn test_gcd() {
    assert_eq!(gcd(&d("1071"), &d("462")), d("21"));
    assert_eq!(gcd(&d("91283"), &d("12311")), d("1"));
    assert_eq!(gcd(&d("2940"), &d("3150")), d("210"));
}

#[test]
fn test_mod_inverse() {
    assert_eq!(mod_inverse_extended(&d("3"), &d("11")), d("4"));
    assert_eq!(mod_inverse_extended(&d("123456789"), &d("1000000007")), d("18633540"));
    assert_eq!(mod_inverse_extended(&d("12311"), &d("91283")), d("83542"));

    assert_eq!(mod_inv(&d("3"), &d("11")), d("4"));
    assert_eq!(mod_inv(&d("123456789"), &d("1000000007")), d("18633540"));
    assert_eq!(mod_inv(&d("12311"), &d("91283")), d("83542"));
}

#[test]
fn test_eg_encrypt() {
    fn compare(p: &str, g: &str, x: &str, k: &str, m: &str, c1: &str, c2: &str) {
        let params = EgParams{ p: d(p), g: d(g) };
        let key = EgKeyPair::from_private(&params, &d(x));
        let (c1_got, c2_got) = eg_encrypt_with_k(&params, &key, &d(m), d(k));
        assert_eq!(c1_got, d(c1));
        assert_eq!(c2_got, d(c2));
    }

    compare("71", "33", "62", "31", "15", "62", "18");
    compare("23", "11", "6", "3", "10", "20", "22");
    compare("809", "3", "68", "89", "100", "345", "517");
    compare("17", "6", "5", "10", "13", "15", "9");
    compare("84265675725482892459719348378630146162719620409152809167814480007059199482163", "5", "2799014790424892046701478888900891009403869701173893426", "23517683968368899022119256606644551548285683288848885921", "87521618088882658227876453", "22954586883013884818653063688294540134886732496160582262267014428782771199687", "56046128113101346099694619669629128017849277484825379502821514323706183544424");
    compare("12658517083168187407924345155971956101250996576825115113297001855799796437288935576230034157578333666497170430505565580165565829633685607504706642034926119", "7", "2001688878140630728014209681954697141876038523595247208", "5446024688717452254835115775456957961297236108858862823", "87521618088882658227876453", "2150519483988769855483983776372336742288374425191291528256965705108393490638750082340115568718132372731853110762124400441550538499580316268601341087676203", "1540471266850557563382406324432354117072109094950140952195099581066490559252112349492583688225692526496193879919152401794896907007394565292272866724291488");
}





